import { useContext, useEffect, useState } from "react";
import { Coordinates, StyledProps, Weather } from "../models/types";
import Forecast from "./Forecast";
import Currentweather from "./Currentweather";
import { styled } from "styled-components";
import { ThemeContext } from "../utils/context/ThemeProvider";

export type CoordProps = {
  coord: Coordinates;
};

export type Forecast = {
  value: number;
  description: string;
  emote: JSX.Element;
};

export type Data = {
  id?: number;
  heure?: number;
  date?: string;
  Temperatures?: number;
  Temperatures_max?: number;
  Temperatures_min?: number;
};

const StyledSvg = styled.svg<StyledProps>`
  fill: ${({ $isDarkMode }) => ($isDarkMode ? "white" : "black")};
`;

export default function Weather({ coord }: CoordProps) {
  const { theme } = useContext(ThemeContext);
  const [weather, setWeather] = useState<Weather>({
    hourly: {
      temperature_2m: [0],
      time: [""],
      is_day: [0],
    },
    daily: {
      time: [""],
      temperature_2m_max: [0],
      temperature_2m_min: [0],
      weathercode: [0],
    },
    current_weather: {
      temperature: 0,
      weathercode: 0,
    },
  });

  const latitude = coord.latitude.toString();
  const longitude = coord.longitude.toString();

  const forecast: Forecast[] = [
    {
      value: 0,
      description: "ensoleillé",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M479.825-770Q467-770 458.5-778.625T450-800v-90q0-12.75 8.675-21.375 8.676-8.625 21.5-8.625 12.825 0 21.325 8.625T510-890v90q0 12.75-8.675 21.375-8.676 8.625-21.5 8.625ZM685-685q-9-9-9-21.1 0-12.1 9-20.9l63-64q9.067-9 21.533-9Q782-800 791-791q9 9 9 21t-9 21l-64 64q-9 9-21 9t-21-9Zm115 235q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T800-510h90q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T890-450h-90ZM479.825-40Q467-40 458.5-48.625T450-70v-90q0-12.75 8.675-21.375 8.676-8.625 21.5-8.625 12.825 0 21.325 8.625T510-160v90q0 12.75-8.675 21.375Q492.649-40 479.825-40ZM233-685l-64-63q-9-8.87-9-21.435T169.391-791Q178-800 190-800q12 0 21 9l64 64q9 9 9 21t-9 21q-9.273 8-21.636 8Q241-677 233-685Zm516 516-64-64q-9-8.8-9-20.9 0-12.1 9-21.1 8.25-8 20.625-8T727-275l65 63q9 9 8.629 21.603-.37 12.604-8.526 21.5-8.896 8.897-21.5 8.897Q758-160 749-169ZM70-450q-12.75 0-21.375-8.675Q40-467.351 40-480.175 40-493 48.625-501.5T70-510h90q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T160-450H70Zm99 280.609Q160-178 160-190q0-12 9-21l64-64q8.25-8 20.625-8T275-274.75q9 9 9 21.375T275-232l-63 63q-8.87 9-21.435 9T169-169.391ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Z" />
        </StyledSvg>
      ),
    },
    {
      value: 1,
      description: "dégagé",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M479.825-770Q467-770 458.5-778.625T450-800v-90q0-12.75 8.675-21.375 8.676-8.625 21.5-8.625 12.825 0 21.325 8.625T510-890v90q0 12.75-8.675 21.375-8.676 8.625-21.5 8.625ZM685-685q-9-9-9-21.1 0-12.1 9-20.9l63-64q9.067-9 21.533-9Q782-800 791-791q9 9 9 21t-9 21l-64 64q-9 9-21 9t-21-9Zm115 235q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T800-510h90q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T890-450h-90ZM479.825-40Q467-40 458.5-48.625T450-70v-90q0-12.75 8.675-21.375 8.676-8.625 21.5-8.625 12.825 0 21.325 8.625T510-160v90q0 12.75-8.675 21.375Q492.649-40 479.825-40ZM233-685l-64-63q-9-8.87-9-21.435T169.391-791Q178-800 190-800q12 0 21 9l64 64q9 9 9 21t-9 21q-9.273 8-21.636 8Q241-677 233-685Zm516 516-64-64q-9-8.8-9-20.9 0-12.1 9-21.1 8.25-8 20.625-8T727-275l65 63q9 9 8.629 21.603-.37 12.604-8.526 21.5-8.896 8.897-21.5 8.897Q758-160 749-169ZM70-450q-12.75 0-21.375-8.675Q40-467.351 40-480.175 40-493 48.625-501.5T70-510h90q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T160-450H70Zm99 280.609Q160-178 160-190q0-12 9-21l64-64q8.25-8 20.625-8T275-274.75q9 9 9 21.375T275-232l-63 63q-8.87 9-21.435 9T169-169.391ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Z" />
        </StyledSvg>
      ),
    },
    {
      value: 2,
      description: "partiellement nuageux",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="m749-169-63-63q-9-9.067-9-21.533Q677-266 686-275q9-9 21.467-9 12.466 0 21.533 9l63 63q9 9.067 9 21.533Q801-178 791.947-169q-9.052 9-21.5 9Q758-160 749-169Zm-509-11q-57.75 0-98.875-41.177t-41.125-99Q100-378 141.125-419 182.25-460 240-460q38.857 0 71.643 20.907T359-382l18.235 41H421q33 0 56 24t23 57q0 33-23.5 56.5T420-180H240Zm318-73q0-61-41-104.5T416-401q-20-56-68-89t-108-30q14-88 82.5-144T480-720q100 0 170 70t70 170q0 78-44.5 140T558-253Zm242-197q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T800-510h90q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T890-450h-90ZM233-685l-64-64q-9-9-9-21t9-21q8.8-9 20.9-9 12.1 0 21.1 9l64 64q9 8.8 9 20.9 0 12.1-9 21.1-9 9-21 9t-21-9Zm452 0q-9-9-9-21.467 0-12.466 9-21.533l63-63q9.067-9 21.533-9Q782-800 791-791q9 9 9 21t-9 21l-64 64q-9 9-21 9t-21-9Zm-205.175-85Q467-770 458.5-778.625T450-800v-90q0-12.75 8.675-21.375 8.676-8.625 21.5-8.625 12.825 0 21.325 8.625T510-890v90q0 12.75-8.675 21.375-8.676 8.625-21.5 8.625Z" />
        </StyledSvg>
      ),
    },
    {
      value: 3,
      description: "nuageux",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M251-160q-88 0-149.5-61.5T40-371q0-78 50-137t127-71q20-97 94-158.5T482-799q112 0 189 81.5T748-522v24q72-2 122 46.5T920-329q0 69-50 119t-119 50H251Z" />
        </StyledSvg>
      ),
    },
    {
      value: 45,
      description: "Brouillard",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M160-210q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-270h400q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T560-210H160Zm560 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T720-270h80q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-210h-80ZM160-370q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-430h80q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T240-370h-80Zm240 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T400-430h400q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-370H400ZM160-530q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-590h440q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T600-530H160Zm600 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T760-590h40q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-530h-40ZM160-690q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-750h200q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T360-690H160Zm360 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T520-750h280q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-690H520Z" />
        </StyledSvg>
      ),
    },
    {
      value: 48,
      description: "Brouillard",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M160-210q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-270h400q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T560-210H160Zm560 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T720-270h80q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-210h-80ZM160-370q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-430h80q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T240-370h-80Zm240 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T400-430h400q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-370H400ZM160-530q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-590h440q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T600-530H160Zm600 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T760-590h40q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-530h-40ZM160-690q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-750h200q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T360-690H160Zm360 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T520-750h280q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-690H520Z" />
        </StyledSvg>
      ),
    },
    {
      value: 51,
      description: "Légère bruine",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M558-83q-11 5-23.5 1T517-97l-69-138q-5-11-1.5-23.5T461-276q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T558-83Zm240-1q-11 5-23.5 1T757-98l-69-138q-5-11-1.5-23.5T701-277q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T798-84Zm-480 0q-11 5-23.5 1.5T277-97l-69-138q-5-11-1-23.5t15-17.5q11-5 23.5-1.5T263-263l69 139q5 11 1 23t-15 17Zm-28-256q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 53,
      description: "Faible pluie",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M558-83q-11 5-23.5 1T517-97l-69-138q-5-11-1.5-23.5T461-276q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T558-83Zm240-1q-11 5-23.5 1T757-98l-69-138q-5-11-1.5-23.5T701-277q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T798-84Zm-480 0q-11 5-23.5 1.5T277-97l-69-138q-5-11-1-23.5t15-17.5q11-5 23.5-1.5T263-263l69 139q5 11 1 23t-15 17Zm-28-256q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 55,
      description: "Pluie",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M558-83q-11 5-23.5 1T517-97l-69-138q-5-11-1.5-23.5T461-276q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T558-83Zm240-1q-11 5-23.5 1T757-98l-69-138q-5-11-1.5-23.5T701-277q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T798-84Zm-480 0q-11 5-23.5 1.5T277-97l-69-138q-5-11-1-23.5t15-17.5q11-5 23.5-1.5T263-263l69 139q5 11 1 23t-15 17Zm-28-256q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 56,
      description: "Brouillard givrant",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M160-210q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-270h400q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T560-210H160Zm560 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T720-270h80q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-210h-80ZM160-370q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-430h80q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T240-370h-80Zm240 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T400-430h400q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-370H400ZM160-530q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-590h440q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T600-530H160Zm600 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T760-590h40q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-530h-40ZM160-690q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-750h200q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T360-690H160Zm360 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T520-750h280q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-690H520Z" />
        </StyledSvg>
      ),
    },
    {
      value: 57,
      description: "Brouillard givrant",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M160-210q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-270h400q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T560-210H160Zm560 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T720-270h80q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-210h-80ZM160-370q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-430h80q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T240-370h-80Zm240 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T400-430h400q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-370H400ZM160-530q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-590h440q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T600-530H160Zm600 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T760-590h40q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-530h-40ZM160-690q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T160-750h200q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T360-690H160Zm360 0q-12.75 0-21.375-8.675-8.625-8.676-8.625-21.5 0-12.825 8.625-21.325T520-750h280q12.75 0 21.375 8.675 8.625 8.676 8.625 21.5 0 12.825-8.625 21.325T800-690H520Z" />
        </StyledSvg>
      ),
    },
    {
      value: 61,
      description: "Légère pluie",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M558-83q-11 5-23.5 1T517-97l-69-138q-5-11-1.5-23.5T461-276q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T558-83Zm240-1q-11 5-23.5 1T757-98l-69-138q-5-11-1.5-23.5T701-277q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T798-84Zm-480 0q-11 5-23.5 1.5T277-97l-69-138q-5-11-1-23.5t15-17.5q11-5 23.5-1.5T263-263l69 139q5 11 1 23t-15 17Zm-28-256q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 63,
      description: "Pluie",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M558-83q-11 5-23.5 1T517-97l-69-138q-5-11-1.5-23.5T461-276q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T558-83Zm240-1q-11 5-23.5 1T757-98l-69-138q-5-11-1.5-23.5T701-277q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T798-84Zm-480 0q-11 5-23.5 1.5T277-97l-69-138q-5-11-1-23.5t15-17.5q11-5 23.5-1.5T263-263l69 139q5 11 1 23t-15 17Zm-28-256q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 65,
      description: "Forte pluie",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M558-83q-11 5-23.5 1T517-97l-69-138q-5-11-1.5-23.5T461-276q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T558-83Zm240-1q-11 5-23.5 1T757-98l-69-138q-5-11-1.5-23.5T701-277q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T798-84Zm-480 0q-11 5-23.5 1.5T277-97l-69-138q-5-11-1-23.5t15-17.5q11-5 23.5-1.5T263-263l69 139q5 11 1 23t-15 17Zm-28-256q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 66,
      description: "Pluie verglaçante",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M500-40q-20 0-35-14.5T450-89q0-10 3.5-18.5T464-123l26-24q5-4 10-4t10 4l26 24q7 7 10.5 15.5T550-89q0 20-15 34.5T500-40Zm-158-83q-8-8-8-17.5t8-17.5l76-76q8-8 17.5-8t17.5 8q8 8 8 17.5t-8 17.5l-77 77q-8 8-17 7.5t-17-8.5Zm267-50-31-31q-5-5-5-11t5-11l31-31q5-5 11-5t11 5l31 31q5 5 5 11t-5 11l-31 31q-5 5-11 5t-11-5Zm-307-31-31 31q-5 5-11 5t-11-5l-31-31q-5-5-5-11t5-11l31-31q5-5 11-5t11 5l31 31q5 5 5 11t-5 11Zm-12-136q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 67,
      description: "Pluie verglaçante",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M500-40q-20 0-35-14.5T450-89q0-10 3.5-18.5T464-123l26-24q5-4 10-4t10 4l26 24q7 7 10.5 15.5T550-89q0 20-15 34.5T500-40Zm-158-83q-8-8-8-17.5t8-17.5l76-76q8-8 17.5-8t17.5 8q8 8 8 17.5t-8 17.5l-77 77q-8 8-17 7.5t-17-8.5Zm267-50-31-31q-5-5-5-11t5-11l31-31q5-5 11-5t11 5l31 31q5 5 5 11t-5 11l-31 31q-5 5-11 5t-11-5Zm-307-31-31 31q-5 5-11 5t-11-5l-31-31q-5-5-5-11t5-11l31-31q5-5 11-5t11 5l31 31q5 5 5 11t-5 11Zm-12-136q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 71,
      description: "Légère chute de neige",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M259.859-210Q243-210 231.5-221.641t-11.5-28.5Q220-267 231.641-278.5t28.5-11.5Q277-290 288.5-278.359t11.5 28.5Q300-233 288.359-221.5t-28.5 11.5Zm120 130Q363-80 351.5-91.64 340-103.283 340-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T408.359-91.5Q396.718-80 379.859-80Zm120-130Q483-210 471.5-221.641t-11.5-28.5Q460-267 471.641-278.5t28.5-11.5Q517-290 528.5-278.359t11.5 28.5Q540-233 528.359-221.5t-28.5 11.5Zm240 0Q723-210 711.5-221.641t-11.5-28.5Q700-267 711.641-278.5t28.5-11.5Q757-290 768.5-278.359t11.5 28.5Q780-233 768.359-221.5t-28.5 11.5Zm-120 130Q603-80 591.5-91.64 580-103.283 580-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T648.359-91.5Q636.718-80 619.859-80ZM290-380q-86.864 0-148.432-61.52Q80-503.04 80-589.835 80-669 136.5-731 193-793 277-799q32-56 84.5-88.5T480.423-920Q571-920 632.5-862.5T708-720q79 4 125.5 53.5T880-550.377Q880-480 830.417-430 780.833-380 710-380H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 73,
      description: "Chute de neige",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M259.859-210Q243-210 231.5-221.641t-11.5-28.5Q220-267 231.641-278.5t28.5-11.5Q277-290 288.5-278.359t11.5 28.5Q300-233 288.359-221.5t-28.5 11.5Zm120 130Q363-80 351.5-91.64 340-103.283 340-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T408.359-91.5Q396.718-80 379.859-80Zm120-130Q483-210 471.5-221.641t-11.5-28.5Q460-267 471.641-278.5t28.5-11.5Q517-290 528.5-278.359t11.5 28.5Q540-233 528.359-221.5t-28.5 11.5Zm240 0Q723-210 711.5-221.641t-11.5-28.5Q700-267 711.641-278.5t28.5-11.5Q757-290 768.5-278.359t11.5 28.5Q780-233 768.359-221.5t-28.5 11.5Zm-120 130Q603-80 591.5-91.64 580-103.283 580-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T648.359-91.5Q636.718-80 619.859-80ZM290-380q-86.864 0-148.432-61.52Q80-503.04 80-589.835 80-669 136.5-731 193-793 277-799q32-56 84.5-88.5T480.423-920Q571-920 632.5-862.5T708-720q79 4 125.5 53.5T880-550.377Q880-480 830.417-430 780.833-380 710-380H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 75,
      description: "Forte chute de neige",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M259.859-210Q243-210 231.5-221.641t-11.5-28.5Q220-267 231.641-278.5t28.5-11.5Q277-290 288.5-278.359t11.5 28.5Q300-233 288.359-221.5t-28.5 11.5Zm120 130Q363-80 351.5-91.64 340-103.283 340-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T408.359-91.5Q396.718-80 379.859-80Zm120-130Q483-210 471.5-221.641t-11.5-28.5Q460-267 471.641-278.5t28.5-11.5Q517-290 528.5-278.359t11.5 28.5Q540-233 528.359-221.5t-28.5 11.5Zm240 0Q723-210 711.5-221.641t-11.5-28.5Q700-267 711.641-278.5t28.5-11.5Q757-290 768.5-278.359t11.5 28.5Q780-233 768.359-221.5t-28.5 11.5Zm-120 130Q603-80 591.5-91.64 580-103.283 580-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T648.359-91.5Q636.718-80 619.859-80ZM290-380q-86.864 0-148.432-61.52Q80-503.04 80-589.835 80-669 136.5-731 193-793 277-799q32-56 84.5-88.5T480.423-920Q571-920 632.5-862.5T708-720q79 4 125.5 53.5T880-550.377Q880-480 830.417-430 780.833-380 710-380H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 77,
      description: "Chute de neige",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M259.859-210Q243-210 231.5-221.641t-11.5-28.5Q220-267 231.641-278.5t28.5-11.5Q277-290 288.5-278.359t11.5 28.5Q300-233 288.359-221.5t-28.5 11.5Zm120 130Q363-80 351.5-91.64 340-103.283 340-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T408.359-91.5Q396.718-80 379.859-80Zm120-130Q483-210 471.5-221.641t-11.5-28.5Q460-267 471.641-278.5t28.5-11.5Q517-290 528.5-278.359t11.5 28.5Q540-233 528.359-221.5t-28.5 11.5Zm240 0Q723-210 711.5-221.641t-11.5-28.5Q700-267 711.641-278.5t28.5-11.5Q757-290 768.5-278.359t11.5 28.5Q780-233 768.359-221.5t-28.5 11.5Zm-120 130Q603-80 591.5-91.64 580-103.283 580-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T648.359-91.5Q636.718-80 619.859-80ZM290-380q-86.864 0-148.432-61.52Q80-503.04 80-589.835 80-669 136.5-731 193-793 277-799q32-56 84.5-88.5T480.423-920Q571-920 632.5-862.5T708-720q79 4 125.5 53.5T880-550.377Q880-480 830.417-430 780.833-380 710-380H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 80,
      description: "Légères averses",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M558-83q-11 5-23.5 1T517-97l-69-138q-5-11-1.5-23.5T461-276q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T558-83Zm240-1q-11 5-23.5 1T757-98l-69-138q-5-11-1.5-23.5T701-277q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T798-84Zm-480 0q-11 5-23.5 1.5T277-97l-69-138q-5-11-1-23.5t15-17.5q11-5 23.5-1.5T263-263l69 139q5 11 1 23t-15 17Zm-28-256q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 81,
      description: "Averses",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M558-83q-11 5-23.5 1T517-97l-69-138q-5-11-1.5-23.5T461-276q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T558-83Zm240-1q-11 5-23.5 1T757-98l-69-138q-5-11-1.5-23.5T701-277q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T798-84Zm-480 0q-11 5-23.5 1.5T277-97l-69-138q-5-11-1-23.5t15-17.5q11-5 23.5-1.5T263-263l69 139q5 11 1 23t-15 17Zm-28-256q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 82,
      description: "Fortes averses",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M558-83q-11 5-23.5 1T517-97l-69-138q-5-11-1.5-23.5T461-276q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T558-83Zm240-1q-11 5-23.5 1T757-98l-69-138q-5-11-1.5-23.5T701-277q11-5 23.5-1t17.5 15l69 138q5 11 1.5 23.5T798-84Zm-480 0q-11 5-23.5 1.5T277-97l-69-138q-5-11-1-23.5t15-17.5q11-5 23.5-1.5T263-263l69 139q5 11 1 23t-15 17Zm-28-256q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 85,
      description: "Légère chute de neige",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M259.859-210Q243-210 231.5-221.641t-11.5-28.5Q220-267 231.641-278.5t28.5-11.5Q277-290 288.5-278.359t11.5 28.5Q300-233 288.359-221.5t-28.5 11.5Zm120 130Q363-80 351.5-91.64 340-103.283 340-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T408.359-91.5Q396.718-80 379.859-80Zm120-130Q483-210 471.5-221.641t-11.5-28.5Q460-267 471.641-278.5t28.5-11.5Q517-290 528.5-278.359t11.5 28.5Q540-233 528.359-221.5t-28.5 11.5Zm240 0Q723-210 711.5-221.641t-11.5-28.5Q700-267 711.641-278.5t28.5-11.5Q757-290 768.5-278.359t11.5 28.5Q780-233 768.359-221.5t-28.5 11.5Zm-120 130Q603-80 591.5-91.64 580-103.283 580-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T648.359-91.5Q636.718-80 619.859-80ZM290-380q-86.864 0-148.432-61.52Q80-503.04 80-589.835 80-669 136.5-731 193-793 277-799q32-56 84.5-88.5T480.423-920Q571-920 632.5-862.5T708-720q79 4 125.5 53.5T880-550.377Q880-480 830.417-430 780.833-380 710-380H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 86,
      description: "Forte chute de neige",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M259.859-210Q243-210 231.5-221.641t-11.5-28.5Q220-267 231.641-278.5t28.5-11.5Q277-290 288.5-278.359t11.5 28.5Q300-233 288.359-221.5t-28.5 11.5Zm120 130Q363-80 351.5-91.64 340-103.283 340-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T408.359-91.5Q396.718-80 379.859-80Zm120-130Q483-210 471.5-221.641t-11.5-28.5Q460-267 471.641-278.5t28.5-11.5Q517-290 528.5-278.359t11.5 28.5Q540-233 528.359-221.5t-28.5 11.5Zm240 0Q723-210 711.5-221.641t-11.5-28.5Q700-267 711.641-278.5t28.5-11.5Q757-290 768.5-278.359t11.5 28.5Q780-233 768.359-221.5t-28.5 11.5Zm-120 130Q603-80 591.5-91.64 580-103.283 580-120.142t11.641-28.359q11.641-11.5 28.5-11.5t28.359 11.641q11.5 11.641 11.5 28.5T648.359-91.5Q636.718-80 619.859-80ZM290-380q-86.864 0-148.432-61.52Q80-503.04 80-589.835 80-669 136.5-731 193-793 277-799q32-56 84.5-88.5T480.423-920Q571-920 632.5-862.5T708-720q79 4 125.5 53.5T880-550.377Q880-480 830.417-430 780.833-380 710-380H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 95,
      description: "Orages",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="m572-110-45-23q-14-7-16.5-21t7.5-25l78-91q5-5 10.5-7.5T619-280q20 0 27.5 17.5T641-231l-53 61 45 23q14 7 16.5 21t-7.5 25l-78 91q-5 5-10.5 7.5T541 0q-20 0-27.5-17.5T519-49l53-61Zm-240 0-45-23q-14-7-16.5-21t7.5-25l78-91q11-2 24-6t-1-4q20 0 27.5 17.5T401-231l-53 61 45 23q14 7 16.5 21t-7.5 25l-78 91q-11 2-24 6t1 4q-20 0-27.5-17.5T279-49l53-61Zm-42-230q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 96,
      description: "Grêle",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M500-40q-20 0-35-14.5T450-89q0-10 3.5-18.5T464-123l26-24q5-4 10-4t10 4l26 24q7 7 10.5 15.5T550-89q0 20-15 34.5T500-40Zm-158-83q-8-8-8-17.5t8-17.5l76-76q8-8 17.5-8t17.5 8q8 8 8 17.5t-8 17.5l-77 77q-8 8-17 7.5t-17-8.5Zm267-50-31-31q-5-5-5-11t5-11l31-31q5-5 11-5t11 5l31 31q5 5 5 11t-5 11l-31 31q-5 5-11 5t-11-5Zm-307-31-31 31q-5 5-11 5t-11-5l-31-31q-5-5-5-11t5-11l31-31q5-5 11-5t11 5l31 31q5 5 5 11t-5 11Zm-12-136q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
    {
      value: 99,
      description: "Grêle",
      emote: (
        <StyledSvg
          xmlns="http://www.w3.org/2000/svg"
          height="48"
          viewBox="0 -960 960 960"
          width="48"
          $isDarkMode={theme === "dark"}
        >
          <path d="M500-40q-20 0-35-14.5T450-89q0-10 3.5-18.5T464-123l26-24q5-4 10-4t10 4l26 24q7 7 10.5 15.5T550-89q0 20-15 34.5T500-40Zm-158-83q-8-8-8-17.5t8-17.5l76-76q8-8 17.5-8t17.5 8q8 8 8 17.5t-8 17.5l-77 77q-8 8-17 7.5t-17-8.5Zm267-50-31-31q-5-5-5-11t5-11l31-31q5-5 11-5t11 5l31 31q5 5 5 11t-5 11l-31 31q-5 5-11 5t-11-5Zm-307-31-31 31q-5 5-11 5t-11-5l-31-31q-5-5-5-11t5-11l31-31q5-5 11-5t11 5l31 31q5 5 5 11t-5 11Zm-12-136q-87 0-148.5-61.5T80-550q0-79 56.5-141T277-759q32-56 84.5-88.5T480-880q91 0 152.5 57.5T708-680q79 4 125.5 53.5T880-510q0 70-49.5 120T710-340H290Z" />
        </StyledSvg>
      ),
    },
  ];

  const url =
    "https://api.open-meteo.com/v1/forecast?latitude=" +
    latitude +
    "&longitude=" +
    longitude +
    "&hourly=temperature_2m,weathercode,is_day&daily=weathercode,temperature_2m_max,temperature_2m_min&current_weather=true&timezone=auto";

  useEffect(() => {
    async function fetchData() {
      try {
        const response = await fetch(url);
        const responseJson = await response.json();
        setWeather(responseJson);
      } catch (error) {
        console.log(error);
      }
    }
    fetchData();
  }, [url]);

  //  console.log(weather);

  const datesHourly = [];

  for (let i = 0; i < weather?.hourly.time.length; i++) {
    datesHourly.push(new Date(weather.hourly.time[i]));
  }

  const hours = datesHourly.map((hour) => {
    return hour.getHours();
  });

  const formatDates = datesHourly.map((day) => {
    return day.toLocaleDateString("fr-FR").slice(0, 5);
  });

  const datasHourly: Data[] = [];

  for (let i = 0; i < formatDates.length; i++) {
    datasHourly.push({
      id: i,
      date: formatDates[i],
      Temperatures: weather.hourly.temperature_2m[i],
      heure: hours[i],
    });
  }

  const datesDaily = [];

  for (let i = 0; i < weather?.daily.time.length; i++) {
    datesDaily.push(new Date(weather.daily.time[i]));
  }

  const hoursDaily = datesDaily.map((hour) => {
    return hour.getHours();
  });

  const formatDatesDaily = datesDaily.map((day) => {
    return day.toLocaleDateString("fr-FR").slice(0, 5);
  });

  const datasDaily: Data[] = [];

  for (let i = 0; i < formatDatesDaily.length; i++) {
    datasDaily.push({
      id: i,
      date: formatDatesDaily[i],
      Temperatures_max: weather.daily.temperature_2m_max[i],
      Temperatures_min: weather.daily.temperature_2m_min[i],
      heure: hoursDaily[i],
    });
  }

  //  console.log(datasHourly);

  console.log(formatDatesDaily);

  const merged = (arr1: Data[], arr2: Data[]) => {
    const datahourly = arr2.map((hour: Data) => {
      const match = arr1.find(
        (day: Data) => hour.date === day.date && hour.heure === day.heure
      );
      if (match) {
        const mergedObject = {
          ...hour,
          date: match.date,
          Temperatures_max: match.Temperatures_max,
          Temperatures_min: match.Temperatures_min,
          heure: match.heure,
        };
        return mergedObject;
      } else {
        return hour;
      }
    });
    return datahourly;
  };

  const datas = merged(datasDaily, datasHourly);

  return (
    <>
      <Currentweather weather={weather} coord={coord} forecast={forecast} />

      <Forecast
        weather={weather}
        datas={datas}
        formatDatesDaily={formatDatesDaily}
        forecast={forecast}
        datesDaily={datesDaily}
        datasHourly={datasHourly}
      />
    </>
  );
}
